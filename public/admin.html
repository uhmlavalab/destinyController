<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags MUST be first.
        Because bootstrap... -->
  <link rel="icon" href="images/favicon.ico">
  <title>Destiny Controller</title>
  <link href="src/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="src/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

  <style type="text/css">
  .btn {
    margin-bottom:5px;
  }
  .well {
    background:#000000;
  }
  .bgBlack {
    background:#000000;
  }
  .bgOffBlack {
    background:#35393D;
  }
  .textWhite {
    color:#FFFFFF;
  }/*
  .row {
    background:#000000;
    margin-top:10px;
    margin-bottom:10px;
    margin-left:10px;
    margin-right:10px;
  }*/
  .well {
    border: 1px solid black;
    background: black;
  }
  td, th {
    font-size: 30px;
    border: 1px solid black;
    padding: 5px;
  }
  button {

  }
  </style>


</head>




<body onload="main()">

<br><br>
<input style="font-size:30px" id="custRunFile"> <button style="font-size:30px" onclick="sendRunFile()"> Custom File Run (No Tracking) </button>
<br><br>
<input style="font-size:30px" id="custRunFileTracking"> <button style="font-size:30px" onclick="sendRunFileTracking()"> Custom File Run (Tracking)</button>
<br><br>
<button style="font-size:30px" onclick="sendKillApplication()">Kill Last Launched Application</button>

<hr>
<hr>

<br><br>
<h3>Custom Monitor Packet</h3>
<table>
<tr>
  <td>Prefix</td>
  <td>Monitor</td>
  <td>Suffix</td>
</tr>
<tr>
  <td> <input id="custPrefix" type="textarea"> </td>
  <td> <input id="custMon" type="textarea"> </td>
  <td> <input id="custSuffix" type="textarea"> </td>
  <td> <button onclick="sendCustomMonitorPacket()"> Send to specified monitor </button> </td>
</tr>
</table>
<br>
<table>
<tr>
  <td>Prefix</td>
  <td>Suffix</td>
</tr>
<tr>
  <td> <input id="custPrefixAll" type="textarea"> </td>
  <td> <input id="custSuffixAll" type="textarea"> </td>
  <td> <button onclick="sendCustomMonitorPacketAll()"> Send to all monitors in order </button> </td>
</tr>
</table>

<br><br>
<hr>
<button style="font-size:30px" onclick="sendNodeUpdatePacket()"> Update all Nodejs </button>

<br><br>
<hr>
<button style="font-size:30px" onclick="sendRestartPacket()"> Restart </button>

<br><br>
<hr>
<div id="monitorOnOffDiv">
<h3>Not implemented yet</h3>
<h2>Kanaloa Monitors</h2>
</div>

  <!-- jQuery is necessary for Bootstrap
  <script src="src/jquery1113min.js"></script>
  <script src="src/bootstrap/js/bootstrap.js"></script> -->
  <script src="src/websocket.io.js"></script>
  <script src="src/adminWsio.js"></script>
  <script>
    function main() {
      initializeWS(); // in adminWsio.js file
      buildMonitorOnOffTable();
    }


    function buildMonitorOnOffTable() {
      var tbl = document.createElement("table");
      var ttr = document.createElement("tr");
      var tth, ttd, tdiv, tbtn;

      for (var i = 1; i <= 8; i++) {
        tth = document.createElement("th");
        tth.textContent = "Kanaloa" + i;
        ttr.appendChild(tth);
      }
      tbl.appendChild(ttr);
      ttr = document.createElement("tr");

      for (var i = 1; i <= 8; i++) {
        ttd = document.createElement("td");
        tdiv = document.createElement("div");
        tbtn = document.createElement("button");
        tbtn.textContent = "On";
        tbtn.action = "psPreSufOne";
        tbtn.params = ["ka", "01"];
        tdiv.appendChild(tbtn);
        ttd.appendChild(tdiv);


        tdiv = document.createElement("div");
        tbtn = document.createElement("button");
        tbtn.textContent = "Off";
        tdiv.appendChild(tbtn);
        ttd.appendChild(tdiv);

        ttr.appendChild(ttd)
      }
      tbl.appendChild(ttr);

      monitorOnOffDiv.appendChild(tbl);
    } // buildMonitorOnOffTable


    function buttonClickHandler(action, paramArray) {
      wsio.emit("command", {command: action, paramArray:paramArray});
      alert("Command Sent");
    }

    function sendCustomMonitorPacket() {
      var dataToSend = {};
      dataToSend.command = "psPreSufOne";
      dataToSend.paramArray = [];

      if (custPrefix.value.trim().length > 0) {
        dataToSend.paramArray.push(custPrefix.value.trim());
      }
      else { return; }
      if (custMon.value.trim().length > 0) {
        dataToSend.paramArray.push(custMon.value.trim());
      }
      else { return; }
      if (custSuffix.value.trim().length > 0) {
        dataToSend.paramArray.push(custSuffix.value.trim());
      }
      else { return; }
      

      wsio.emit("command", dataToSend);
      alert("Command Sent");
    }

    function sendCustomMonitorPacketAll() {
      var dataToSend = {};
      dataToSend.command = "psPreSufAll";
      dataToSend.paramArray = [];

      if (custPrefixAll.value.trim().length > 0) { dataToSend.paramArray.push(custPrefixAll.value.trim()); }
      else { return; }
      if (custSuffixAll.value.trim().length > 0) { dataToSend.paramArray.push(custSuffixAll.value.trim()); }
      else { return; }

      wsio.emit("command", dataToSend);
      alert("Command Sent");
    }
    
    function sendNodeUpdatePacket() {
      wsio.emit("command", {command: "updateNodejsFromRepo"});
      alert("Command Sent");
    }
    
    function sendRestartPacket() {
      wsio.emit("command", {command: "restartNow"});
      alert("Command Sent");
    }

    function sendRunFile() {
      var filePath = custRunFile.value.trim();
      if (filePath.length <= 0) {
        return;
      } else {
        var dataToSend = {};
        dataToSend.command = "destinyTest:" + filePath;
        wsio.emit("command", dataToSend);
        alert("Command Sent");
      }
    }
    function sendRunFileTracking() {
      var filePath = custRunFileTracking.value.trim();
      if (filePath.length <= 0) {
        return;
      } else {
        var dataToSend = {};
        dataToSend.command = "destinyTestTracking:" + filePath;
        wsio.emit("command", dataToSend);
        alert("Command Sent");
      }
    }
    function sendKillApplication() {
      wsio.emit("command", {command: "destinyKillApps:", paramArray:[] });
      alert("Command Sent");
    }



    //-----------------------------------------------------------------------------------------------------------------debugPrint()
    function debugPrint(msg, prefix) {
      if (prefix !== undefined) {
        msg = prefix + ">\t\t" + msg;
      }
      msg = "debug:" + msg;
      console.log(msg);
    }

  </script>
</body>
</html>


